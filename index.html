<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Cockgotchi - Virtual Pet Game</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box}

  /* ===== LAYOUT PARA COLOCAR O OVO AO LADO ===== */
  body{
    font-family:'Courier New',monospace;
    background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
    min-height:100vh;display:flex;justify-content:center;align-items:center;padding:10px
  }
  .app-wrap{
    display:flex;align-items:flex-start;gap:18px;flex-wrap:wrap;max-width:980px;width:100%;justify-content:center
  }

  .game-container{
    background:#2a2a2a;border-radius:20px;padding:20px;box-shadow:0 20px 40px rgba(0,0,0,.3);
    max-width:420px;width:100%;border:4px solid #4a4a4a
  }
  .header{text-align:center;margin-bottom:20px}
  .title{color:#00ff88;font-size:28px;font-weight:bold;text-shadow:2px 2px 0 #004d2a;margin-bottom:15px}
  .nav-buttons{display:flex;gap:10px;justify-content:center;margin-bottom:20px}
  .nav-btn{
    background:linear-gradient(45deg,#ff6b6b,#ee5a6f);color:#fff;padding:8px 16px;text-decoration:none;
    border-radius:15px;font-weight:bold;font-size:12px;box-shadow:0 4px 8px rgba(0,0,0,.2);transition:transform .2s
  }
  .nav-btn:hover{transform:translateY(-2px)}

  .screen{
    background:linear-gradient(135deg,#e3f2fd 0%,#bbdefb 100%);
    border:4px solid #333;border-radius:10px;height:300px;display:flex;justify-content:center;align-items:flex-end;
    margin-bottom:20px;position:relative;overflow:hidden
  }
  .ground{position:absolute;bottom:0;left:0;right:0;height:60px;background:linear-gradient(to bottom,#8bc34a,#689f38);border-top:3px solid #558b2f}
  .grass{position:absolute;bottom:55px;width:100%;height:10px;background:repeating-linear-gradient(90deg,transparent,transparent 2px,#4caf50 2px,#4caf50 4px)}
  .clouds{
    position:absolute;top:12px;width:120%;height:44px;left:-10%;
    background:
      radial-gradient(ellipse 25px 15px at 30px 20px,#fff 50%,transparent 51%),
      radial-gradient(ellipse 35px 20px at 120px 25px,#fff 50%,transparent 51%),
      radial-gradient(ellipse 20px 12px at 260px 15px,#fff 50%,transparent 51%),
      radial-gradient(ellipse 30px 18px at 380px 22px,#fff 50%,transparent 51%);
    animation:cloudMove 20s linear infinite
  }
  @keyframes cloudMove{0%{transform:translateX(0)}100%{transform:translateX(-50px)}}

  /* Peacock */
  .peacock-wrap{position:absolute;bottom:0px;left:50%;transform:translateX(-50%);z-index:10}
  .peacock{
    width:180px;height:170px;position:relative;transition:transform .25s ease,filter .25s ease,opacity .25s ease
  }

  /* Tail fan with eyes */
  .tail{
    position:absolute;bottom:40px;left:50%;transform:translateX(-50%);width:170px;height:110px;transform-origin:bottom center;
    pointer-events:none
  }
  .feather{
    position:absolute;bottom:0;left:50%;transform-origin:bottom center;transform:translateX(-50%);
    width:22px;height:88px;border-radius:16px 16px 0 0;
    background:linear-gradient(180deg,#0b2e6d 0%,#14509a 55%,#1aa0b8 100%);
    box-shadow:inset 0 -10px 16px rgba(0,0,0,.15)
  }
  .feather:after{
    content:"";position:absolute;top:8px;left:50%;transform:translateX(-50%);
    width:16px;height:16px;border-radius:50%;
    background:
      radial-gradient(circle at 50% 50%, #1fbdd2 0 35%, #0e3d7a 36% 65%, transparent 66% 100%),
      radial-gradient(circle at 50% 50%, rgba(255,215,0,.95) 0 48%, transparent 49% 100%)
  }

  /* Fan angles (15 feathers) */
  .feather:nth-child(1){transform:translateX(-50%) rotate(-60deg)}
  .feather:nth-child(2){transform:translateX(-50%) rotate(-52deg)}
  .feather:nth-child(3){transform:translateX(-50%) rotate(-44deg)}
  .feather:nth-child(4){transform:translateX(-50%) rotate(-36deg)}
  .feather:nth-child(5){transform:translateX(-50%) rotate(-28deg)}
  .feather:nth-child(6){transform:translateX(-50%) rotate(-20deg)}
  .feather:nth-child(7){transform:translateX(-50%) rotate(-12deg)}
  .feather:nth-child(8){transform:translateX(-50%) rotate(-4deg)}
  .feather:nth-child(9){transform:translateX(-50%) rotate(4deg)}
  .feather:nth-child(10){transform:translateX(-50%) rotate(12deg)}
  .feather:nth-child(11){transform:translateX(-50%) rotate(20deg)}
  .feather:nth-child(12){transform:translateX(-50%) rotate(28deg)}
  .feather:nth-child(13){transform:translateX(-50%) rotate(36deg)}
  .feather:nth-child(14){transform:translateX(-50%) rotate(44deg)}
  .feather:nth-child(15){transform:translateX(-50%) rotate(52deg)}

  /* Tail state mods */
  .peacock .tail{filter:saturate(1)}
  .peacock.is-happy .tail{animation:tailPulse 2.8s ease-in-out infinite}
  .peacock.is-sad .tail{opacity:.85}
  .peacock.is-hungry .tail{opacity:.75;filter:saturate(.85)}
  .peacock.is-starving .tail{opacity:.6;filter:grayscale(.2) saturate(.7)}
  .peacock.is-sleeping .tail{opacity:.6;filter:saturate(.7)}
  .peacock.is-sick .tail{filter:hue-rotate(40deg) saturate(.8)}
  .peacock.is-dead .tail{opacity:.2;filter:grayscale(1)}
  @keyframes tailPulse{0%,100%{transform:translateX(-50%) scale(1)}50%{transform:translateX(-50%) scale(1.06)}}

  /* Body */
  .body{
    position:absolute;bottom:28px;left:50%;transform:translateX(-50%);
    width:74px;height:92px;border-radius:46% 46% 50% 50%;
    background:linear-gradient(135deg,#1e3c72 0%,#2a5298 55%,#3f7cac 100%);
    box-shadow:inset 0 0 12px rgba(255,255,255,.18)
  }
  .belly{position:absolute;bottom:18px;left:50%;transform:translateX(-50%);width:48px;height:26px;border-radius:50%;
    background:radial-gradient(circle at 50% 35%, rgba(255,255,255,.25), transparent 60%)}
  .peacock.is-hungry .belly{animation:tummyRum 1.6s ease-in-out infinite}
  .peacock.is-starving .belly{animation:tummyRumFast 1s ease-in-out infinite}
  @keyframes tummyRum{0%,100%{transform:translateX(-50%) scale(1)}50%{transform:translateX(-50%) scale(1.05)}}
  @keyframes tummyRumFast{0%,100%{transform:translateX(-50%) scale(1)}50%{transform:translateX(-50%) scale(1.08)}}

  /* Neck + Head */
  .neck{
    position:absolute;bottom:88px;left:50%;transform:translateX(-50%);
    width:26px;height:62px;border-radius:16px;background:linear-gradient(180deg,#2a5298,#1e3c72)
  }
  .head{
    position:absolute;bottom:142px;left:50%;transform:translateX(-50%);
    width:38px;height:38px;border-radius:50%;
    background:radial-gradient(circle at 30% 30%,#4f9cf9 0%,#2a5298 60%,#1e3c72 100%);
    box-shadow:0 2px 8px rgba(0,0,0,.3)
  }
  .crest{
    position:absolute;bottom:178px;left:50%;transform:translateX(-50%);
    width:28px;height:16px;
    background:
      radial-gradient(circle 2px at 6px 2px,#00d4aa,transparent 3px),
      radial-gradient(circle 2px at 14px 0px,#ff6b6b,transparent 3px),
      radial-gradient(circle 2px at 22px 2px,#ffa500,transparent 3px)
  }
  .beak{
    position:absolute;bottom:154px;left:calc(50% + 18px);
    width:0;height:0;border-left:10px solid #ffa500;border-top:4px solid transparent;border-bottom:4px solid transparent
  }

  /* Eye */
  .eye{
    position:absolute;bottom:156px;left:calc(50% + 6px);width:8px;height:8px;border-radius:50%;background:#000
  }
  .eye:after{content:"";position:absolute;width:3px;height:3px;border-radius:50%;right:1px;top:1px;background:#fff}
  .eyelid{
    position:absolute;bottom:158px;left:calc(50% + 5px);width:10px;height:6px;border-radius:6px;background:#333;opacity:0;transition:opacity .2s
  }
  .peacock.is-sleeping .eyelid{opacity:1}
  .eye-x{position:absolute;bottom:156px;left:calc(50% + 5px);width:12px;height:12px;opacity:0}
  .eye-x:before,.eye-x:after{content:"";position:absolute;left:0;top:5px;width:12px;height:2px;background:#111;transform:rotate(45deg)}
  .eye-x:after{transform:rotate(-45deg)}
  .peacock.is-dead .eye{opacity:0}
  .peacock.is-dead .eye-x{opacity:1}

  /* Legs */
  .legs{position:absolute;bottom:28px;left:50%;transform:translateX(-50%);width:36px;height:18px}
  .leg{position:absolute;bottom:0;width:3px;height:18px;background:#ffa500}
  .leg:nth-child(1){left:8px}
  .leg:nth-child(2){right:8px}
  .leg:after{content:"";position:absolute;bottom:-3px;left:-2px;width:9px;height:2px;background:#ffa500;border-radius:0 0 50% 50%}

  /* Dirt splats */
  .dirt{
    position:absolute;bottom:46px;left:50%;transform:translateX(-50%);
    width:70px;height:24px;border-radius:12px;background:rgba(80,48,18,.9);filter:blur(.4px);opacity:0;transition:opacity .2s
  }
  .peacock.is-dirty .dirt{opacity:1}
  .dirt:after,.dirt:before{
    content:"";position:absolute;border-radius:50%;background:rgba(85,52,20,.9)
  }
  .dirt:after{width:18px;height:12px;left:8px;top:-6px}
  .dirt:before{width:14px;height:10px;right:6px;top:-4px}

  /* Global state transforms */
  .peacock.is-happy{animation:peacockBounce 2.2s infinite}
  .peacock.is-sad{animation:peacockSway 3s infinite;filter:grayscale(.15)}
  .peacock.is-sick{animation:peacockShake .5s infinite;filter:hue-rotate(30deg) saturate(.8)}
  .peacock.is-hungry .neck{transform:translateX(-50%) translateY(2px)}
  .peacock.is-starving{filter:grayscale(.25) saturate(.8)}
  .peacock.is-sleeping{opacity:.85}
  .peacock.is-dead{
    transform:rotate(-86deg) translateY(24px);
    filter:grayscale(1) brightness(.8);opacity:.95
  }
  @keyframes peacockBounce{0%,20%,50%,80%,100%{transform:translateY(0) scale(1)}40%{transform:translateY(-12px) scale(1.03)}60%{transform:translateY(-4px) scale(1.01)}}
  @keyframes peacockSway{0%,100%{transform:rotate(0)}25%{transform:rotate(-3deg)}75%{transform:rotate(3deg)}}
  @keyframes peacockShake{0%,100%{transform:translateX(0)}25%{transform:translateX(-2px)}75%{transform:translateX(2px)}}

  /* Zzz */
  .zzz{position:absolute;bottom:180px;left:calc(50% + 34px);font-size:14px;opacity:0;pointer-events:none}
  .peacock.is-sleeping .zzz{animation:zz 2s ease-in-out infinite}
  @keyframes zz{0%{opacity:0;transform:translateY(0)}50%{opacity:1;transform:translateY(-12px)}100%{opacity:0;transform:translateY(-24px)}}

  /* Message and age/state badges */
  .message{
    position:absolute;top:10px;left:10px;right:10px;background:rgba(0,0,0,.8);color:#fff;padding:8px;border-radius:8px;
    font-size:12px;text-align:center;opacity:0;transition:opacity .3s;z-index:20
  }
  .message.show{opacity:1}
  .age-display{
    position:absolute; right:10px; bottom:12px;
    background:rgba(0,255,136,0.2); color:#00ff88;
    padding:4px 8px; border-radius:8px; font-size:11px;
    border:1px solid #00ff88; z-index:20
  }
  .state-badge{
    position:absolute;top:10px;left:10px;background:rgba(0,0,0,.65);color:#fff;padding:4px 8px;border-radius:8px;font-size:11px;z-index:20
  }

  /* Rain */
  .rain{
    position:absolute;top:0;left:0;width:100%;height:100%;
    background:linear-gradient(transparent 0%,rgba(135,206,235,.1) 50%,transparent 100%),
               repeating-linear-gradient(90deg,transparent,transparent 2px,rgba(135,206,235,.3) 2px,rgba(135,206,235,.3) 3px);
    animation:rain .3s linear infinite;opacity:0
  }
  @keyframes rain{0%{background-position:0 0}100%{background-position:0 10px}}

  .status-bars{margin-bottom:20px}
  .status-item{margin-bottom:10px}
  .status-label{color:#fff;font-size:14px;margin-bottom:5px;display:flex;justify-content:space-between}
  .status-bar{background:#333;height:20px;border-radius:10px;overflow:hidden;border:2px solid #555}
  .status-fill{height:100%;transition:width .5s ease;border-radius:8px}
  .hunger-fill{background:linear-gradient(90deg,#ff4757,#ff6b6a)}
  .happiness-fill{background:linear-gradient(90deg,#ffa502,#ffdd59)}
  .health-fill{background:linear-gradient(90deg,#2ed573,#7bed9f)}

  .controls{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
  .control-btn{
    background:linear-gradient(45deg,#4834d4,#686de0);color:#fff;border:none;padding:15px 10px;border-radius:15px;
    font-weight:bold;font-size:12px;cursor:pointer;transition:all .2s;box-shadow:0 4px 8px rgba(0,0,0,.2)
  }
  .control-btn:hover{transform:translateY(-2px);box-shadow:0 6px 12px rgba(0,0,0,.3)}
  .control-btn:active{transform:translateY(0)}

  /* Particles and hearts */
  .heart{position:absolute;font-size:20px;color:#ff6b6b;animation:floatHeart 2s ease-out forwards;pointer-events:none}
  @keyframes floatHeart{0%{transform:translateY(0) scale(0);opacity:1}50%{transform:translateY(-30px) scale(1);opacity:1}100%{transform:translateY(-60px) scale(0);opacity:0}}
  .particle{position:absolute;border-radius:50%;pointer-events:none;animation:particleFloat 3s ease-out forwards}
  @keyframes particleFloat{0%{transform:translateY(0) rotate(0);opacity:1}100%{transform:translateY(-50px) rotate(360deg);opacity:0}}

  /* Interactive add-ons (no layout changes) */
  .item{position:absolute;font-size:22px;pointer-events:none;will-change:left,top,transform;z-index:30;filter:drop-shadow(0 2px 2px rgba(0,0,0,.2))}
  .splash{position:absolute;width:6px;height:6px;border-radius:50%;background:#8fd3ff;opacity:.9;will-change:left,top;z-index:25}

  /* Short action animations attached and removed via JS */
  .peacock.act-peck .head{animation:headPeck .45s ease-in-out 2}
  .peacock.act-peck .neck{animation:neckPeck .45s ease-in-out 2}
  @keyframes headPeck{0%,100%{bottom:142px}50%{bottom:136px}}
  @keyframes neckPeck{0%,100%{bottom:88px}50%{bottom:84px}}

  .peacock-wrap.act-hop{animation:hop .8s ease-out}
  @keyframes hop{0%,100%{bottom:0}50%{bottom:14px}}

  .tail.act-flare{animation:tailFlare 1.2s ease-out}
  @keyframes tailFlare{
    0%{transform:translateX(-50%) scale(1)}
    30%{transform:translateX(-50%) scale(1.12)}
    60%{transform:translateX(-50%) scale(1.02)}
    100%{transform:translateX(-50%) scale(1)}
  }

  .peacock-wrap.act-shake{animation:wrapShake .5s ease-in-out}
  @keyframes wrapShake{
    0%,100%{margin-left:0}
    20%{margin-left:-6px}
    40%{margin-left:6px}
    60%{margin-left:-4px}
    80%{margin-left:4px}
  }

  .head.act-nuzzle{animation:headNuzzle 1s ease-in-out}
  .neck.act-nuzzle{animation:neckNuzzle 1s ease-in-out}
  @keyframes headNuzzle{
    0%,100%{left:calc(50% + 6px)}
    50%{left:calc(50% + 14px)}
  }
  @keyframes neckNuzzle{
    0%,100%{height:62px}
    50%{height:58px}
  }

  /* ======= EGG BURN PANEL (EXTERNO AO GAME) ======= */
  .egg-panel{
    width:280px;flex:0 0 280px;display:flex;flex-direction:column;align-items:center;gap:10px
  }
  .egg-burn{
    position:relative; width:100%; padding:16px 14px 14px;
    background:
      radial-gradient(140px 100px at 50% 18%, rgba(255,255,255,.95), rgba(255,255,255,.75) 60%, rgba(255,255,255,.55) 100%),
      linear-gradient(180deg,#ffffff,#f3f3f3);
    border:3px solid #ddd;
border-radius:12px;
overflow:hidden;

    box-shadow:0 10px 20px rgba(0,0,0,.25), inset 0 -8px 18px rgba(0,0,0,.06), inset 0 8px 14px rgba(255,255,255,.5)
  }
  .egg-header{
    text-align:center; font-weight:800; font-size:14px; color:#222; letter-spacing:.5px;
    text-transform:uppercase; margin-top:4px
  }
  .egg-badge{
    margin:8px auto 8px; width:88%; height:30px; border-radius:15px;
    background:linear-gradient(90deg,#ff6b6b,#ffa502);
    display:flex; align-items:center; justify-content:center; color:#fff; font-size:13px; font-weight:800;
    box-shadow:0 3px 8px rgba(0,0,0,.15)
  }
  .egg-metrics{font-size:13px; color:#111; line-height:1.35; text-align:center; margin-bottom:8px}
  .egg-metrics strong{color:#d35400}
  .egg-total{
    font-size:13px; font-weight:800; color:#016b44; text-align:center;
    background:rgba(1,107,68,.12); border:1px solid rgba(1,107,68,.35); padding:6px 8px; border-radius:10px; margin:0 6px 8px
  }
  .egg-list{
    height:180px; overflow:auto; background:#ffffff; border:1px solid rgba(0,0,0,.08);
    border-radius:10px; padding:8px; box-shadow:inset 0 1px 0 rgba(255,255,255,.6)
  }
  .burn-row{
    display:flex; align-items:center; justify-content:space-between;
    font-size:12px; background:#fff; padding:6px 8px; border-radius:8px; margin-bottom:6px;
    box-shadow:0 1px 2px rgba(0,0,0,.08); color:#222
  }
  .burn-row b{font-size:12px; color:#333}
  .burn-row .amt{font-weight:900; color:#e25822}
  .egg-note{font-size:11px;color:#333;text-align:center;opacity:.85;margin-top:4px}
  .egg-flare{animation:eggPulse 1.1s ease-out}
  @keyframes eggPulse{
    0%{transform:scale(1); box-shadow:0 10px 20px rgba(0,0,0,.25), 0 0 0 0 rgba(226,88,34,.5)}
    50%{transform:scale(1.03); box-shadow:0 10px 22px rgba(0,0,0,.28), 0 0 0 12px rgba(226,88,34,.0)}
    100%{transform:scale(1); box-shadow:0 10px 20px rgba(0,0,0,.25), 0 0 0 0 rgba(226,88,34,0)}
  }

  @media(max-width:480px){
    .game-container{max-width:360px;padding:16px}
    .title{font-size:24px}
    .screen{height:260px}
    .peacock{width:160px;height:150px}
    .controls{gap:8px}
    .control-btn{padding:12px 8px;font-size:11px}
    .egg-panel{width:100%;flex:1 1 100%}
    .egg-burn{max-width:360px;margin:0 auto}
  }
</style>
</head>
<body>
  <div class="app-wrap">
    <!-- ===== CAIXA DO GAME (inalterada em comportamento) ===== -->
    <div class="game-container">
      <div class="header">
        <h1 class="title">🦚 Cockgotchi</h1>
        <div class="nav-buttons">
          <a href="https://pump.tires/token/0x2541A85E33F75729ec5bf7f13df82b8bCE357490" class="nav-btn">💰 Buy</a>
          <a href="https://x.com/cockgotchi" class="nav-btn">🐦 Twitter</a>
        </div>
      </div>

      <div class="screen" id="screen">
        <div class="clouds"></div>
        <div class="state-badge" id="stateBadge">State: Happy</div>
        <div class="message" id="message"></div>
        <div class="age-display" id="age">Age: 0 days</div>

        <div class="peacock-wrap" id="peacockWrap">
          <div class="peacock" id="peacock">
            <div class="tail" aria-hidden="true" id="tail">
              <div class="feather"></div><div class="feather"></div><div class="feather"></div><div class="feather"></div>
              <div class="feather"></div><div class="feather"></div><div class="feather"></div><div class="feather"></div>
              <div class="feather"></div><div class="feather"></div><div class="feather"></div><div class="feather"></div>
              <div class="feather"></div><div class="feather"></div><div class="feather"></div>
            </div>

            <div class="body"></div>
            <div class="belly"></div>
            <div class="neck"></div>
            <div class="head"></div>
            <div class="crest"></div>
            <div class="beak"></div>
            <div class="eye"></div>
            <div class="eyelid" id="eyelid"></div>
            <div class="eye-x"></div>

            <div class="legs">
              <div class="leg"></div>
              <div class="leg"></div>
            </div>

            <div class="dirt" aria-hidden="true"></div>
            <div class="zzz">Z z z</div>
          </div>
        </div>

        <div class="grass"></div>
        <div class="ground"></div>
      </div>

      <div class="status-bars">
        <div class="status-item">
          <div class="status-label"><span>🍎 Hunger</span><span id="hungerValue">100</span></div>
          <div class="status-bar"><div class="status-fill hunger-fill" id="hungerBar" style="width:100%"></div></div>
        </div>
        <div class="status-item">
          <div class="status-label"><span>😊 Happiness</span><span id="happinessValue">100</span></div>
          <div class="status-bar"><div class="status-fill happiness-fill" id="happinessBar" style="width:100%"></div></div>
        </div>
        <div class="status-item">
          <div class="status-label"><span>💚 Health</span><span id="healthValue">100</span></div>
          <div class="status-bar"><div class="status-fill health-fill" id="healthBar" style="width:100%"></div></div>
        </div>
      </div>

      <div class="controls">
        <button class="control-btn" onclick="feedPeacock()">🍎 Feed</button>
        <button class="control-btn" onclick="playWithPeacock()">🎮 Play</button>
        <button class="control-btn" onclick="healPeacock()">💊 Medicine</button>
        <button class="control-btn" onclick="cleanPeacock()">🧽 Clean</button>
        <button class="control-btn" onclick="petPeacock()">👋 Pet</button>
        <button class="control-btn" onclick="putToSleep()">😴 Sleep</button>
      </div>
    </div>

    <!-- ===== OVO / REGISTRO DE QUEIMA (fora do game) ===== -->
    <aside class="egg-panel" aria-label="Registro de queima GOTCHI">
      <div class="egg-burn" id="eggBurn">
        <div class="egg-header">🔥 GOTCHI Burn Registry</div>
        <div class="egg-badge">Day × 100 tokens</div>
        <div class="egg-metrics">
          Hoje: <strong id="eggToday">0</strong> tokens
        </div>
        <div class="egg-total" id="eggTotal">Total burned: 0</div>
        <div class="egg-list" id="eggList"></div>
        <div class="egg-note">Each new day of the bird's life records <b>day × 100</b> GOTCHI burned.</div>
      </div>
    </aside>
  </div>

<script>
class Cockgotchie {
  constructor(){
    this.stats = { hunger:100, happiness:100, health:100, age:0, sleeping:false, sick:false, dirty:false };
    this.peacockEl = document.getElementById('peacock');
    this.peacockWrap = document.getElementById('peacockWrap');
    this.tailEl = document.getElementById('tail');
    this.eyelidEl = document.getElementById('eyelid');
    this.messageEl = document.getElementById('message');
    this.ageEl = document.getElementById('age');
    this.screenEl = document.getElementById('screen');
    this.stateBadge = document.getElementById('stateBadge');
    this.dead = false;

    /* Egg registry refs */
    this.eggEl = document.getElementById('eggBurn');
    this.eggTodayEl = document.getElementById('eggToday');
    this.eggTotalEl = document.getElementById('eggTotal');
    this.eggListEl = document.getElementById('eggList');
    this.burnLog = this._loadBurnLog();

    this.init();
  }

  init(){
    this.updateDisplay();
    this.updatePeacockState();
    this._updateEggUI();
    this.showMessage("Hello! I'm your Cockgotchi peacock! 🦚");
    this.createParticles();
    this.startLifeCycle();
  }

  /* Cosmetic particles */
  createParticles(){
    setInterval(()=>{
      if(this.dead) return;
      if(Math.random() < 0.3 && this.stats.happiness > 70){ this.createHeart(); }
      if(Math.random() < 0.2){ this.createSparkle(); }
    }, 2000);
  }
  createHeart(){
    const heart = document.createElement('div');
    heart.className = 'heart'; heart.textContent = '💖';
    heart.style.left = (Math.random()*80+10)+'%';
    heart.style.bottom = '90px';
    this.screenEl.appendChild(heart);
    setTimeout(()=>heart.remove(), 2000);
  }
  createSparkle(){
    const p = document.createElement('div');
    p.className = 'particle';
    const s = (Math.random()*6+3)|0;
    p.style.width = s+'px'; p.style.height = s+'px';
    p.style.background = ['#ffeb3b','#e91e63','#00bcd4','#4caf50'][Math.floor(Math.random()*4)];
    p.style.left = (Math.random()*90+5)+'%';
    p.style.bottom = (Math.random()*120+60)+'px';
    this.screenEl.appendChild(p);
    setTimeout(()=>p.remove(),3000);
  }

  startLifeCycle(){
    // Tick
    this.tickTimer = setInterval(()=>{
      if(this.dead) return;

      if(!this.stats.sleeping){
        this.stats.hunger = Math.max(0, this.stats.hunger - 0.8);
        this.stats.happiness = Math.max(0, this.stats.happiness - 0.4);
        if(this.stats.hunger < 30 || this.stats.happiness < 30){
          this.stats.health = Math.max(0, this.stats.health - 0.8);
        } else {
          this.stats.health = Math.max(0, this.stats.health - 0.12);
        }
      } else {
        this.stats.health = Math.min(100, this.stats.health + 0.22);
        this.stats.happiness = Math.min(100, this.stats.happiness + 0.12);
        this.stats.hunger = Math.max(0, this.stats.hunger - 0.35);
      }

      if(this.stats.health <= 0 && !this.dead){
        this.dead = true;
        this.updatePeacockState();
        this.showMessage("... 🪦 Your peacock has died.");
      }

      this.updateDisplay();
      this.updatePeacockState();
    }, 1000);

    // Age
    this.ageTimer = setInterval(()=>{
      if(this.dead) return;
      this.stats.age++;
      this.updateDisplay();
      this._registerDailyBurn();  // burn registry per new day
      if(this.stats.age % 10 === 0){
        this.showMessage(`I'm ${this.stats.age} days old now! 🎂`);
        this.createCelebration();
      }
    }, 8000);

    // Random events
    this.randTimer = setInterval(()=>{
      if(this.dead) return;
      this.randomEvent();
    }, 20000);

    // Weather
    this.weatherTimer = setInterval(()=>{
      if(this.dead) return;
      this.weatherEffect();
    }, 30000);
  }

  createCelebration(){
    for(let i=0;i<5;i++){
      setTimeout(()=>{ this.createHeart(); this.createSparkle(); }, i*200);
    }
  }

  weatherEffect(){
    if(Math.random() < 0.3){
      const rain = document.createElement('div');
      rain.className = 'rain'; rain.style.opacity = '1';
      this.screenEl.appendChild(rain);
      this.stats.happiness = Math.max(0, this.stats.happiness - 10);
      this.showMessage("Oh no! It's raining! I don't like getting wet! ☔");
      setTimeout(()=>{
        rain.style.opacity = '0';
        setTimeout(()=>rain.remove(), 1000);
      }, 5000);
    }
  }

  updateDisplay(){
    document.getElementById('hungerBar').style.width = this.stats.hunger + '%';
    document.getElementById('happinessBar').style.width = this.stats.happiness + '%';
    document.getElementById('healthBar').style.width = this.stats.health + '%';
    document.getElementById('hungerValue').textContent = Math.round(this.stats.hunger);
    document.getElementById('happinessValue').textContent = Math.round(this.stats.happiness);
    document.getElementById('healthValue').textContent = Math.round(this.stats.health);
    this.ageEl.textContent = `Age: ${this.stats.age} days`;
    this._updateEggUI();
  }

  stateText(){
    if(this.dead) return 'Dead';
    if(this.stats.sleeping) return 'Sleeping';
    if(this.stats.hunger < 10) return 'Starving';
    if(this.stats.hunger < 25) return 'Hungry';
    if(this.stats.dirty) return 'Dirty';
    if(this.stats.health < 30) return 'Sick';
    if(this.stats.happiness > 70 && this.stats.hunger > 50 && this.stats.health > 50) return 'Happy';
    return 'Neutral';
  }

  updatePeacockState(){
    const el = this.peacockEl;
    el.className = 'peacock';
    if(this.dead){
      el.classList.add('is-dead');
      this.stateBadge.textContent = 'State: Dead';
      return;
    }
    if(this.stats.sleeping) el.classList.add('is-sleeping');
    if(this.stats.health < 30) el.classList.add('is-sick');
    if(this.stats.dirty) el.classList.add('is-dirty');
    if(this.stats.hunger < 10){
      el.classList.add('is-starving');
    } else if(this.stats.hunger < 25){
      el.classList.add('is-hungry');
    }
    if(!this.stats.sleeping && this.stats.health >= 30){
      if(this.stats.happiness > 70 && this.stats.hunger > 50){
        el.classList.add('is-happy');
      } else if(this.stats.hunger < 50 || this.stats.happiness < 50){
        el.classList.add('is-sad');
      }
    }
    this.stateBadge.textContent = `State: ${this.stateText()}`;
  }

  showMessage(text){
    const m = this.messageEl;
    m.textContent = text;
    m.classList.add('show');
    clearTimeout(this._msgT);
    this._msgT = setTimeout(()=>m.classList.remove('show'), 3000);
  }

  /* === Interaction animations (add-ons) === */
  _once(el, cls, ms){
    el.classList.add(cls);
    setTimeout(()=>el.classList.remove(cls), ms);
  }
  _getBeakPoint(){
    const beak = this.peacockEl.querySelector('.beak').getBoundingClientRect();
    const screen = this.screenEl.getBoundingClientRect();
    return {
      x: beak.left - screen.left + beak.width*0.2,
      y: beak.top - screen.top + beak.height*0.5
    };
  }
  _animateEmojiToBeak(emoji, {startX=24, startY=null, duration=900}={}){
    return new Promise(res=>{
      const item = document.createElement('div');
      item.className = 'item';
      item.textContent = emoji;
      const screen = this.screenEl.getBoundingClientRect();
      const groundY = screen.height - 76;
      item.style.left = startX+'px';
      item.style.top = (startY==null? groundY : startY)+'px';
      this.screenEl.appendChild(item);

      const P0 = {x:startX, y:(startY==null? groundY : startY)};
      const P2 = this._getBeakPoint();
      const cx = (P0.x + P2.x)/2;
      const cy = Math.min(P0.y, P2.y) - 120;
      const P1 = {x:cx, y:cy};

      const t0 = performance.now();
      const ease = t => t<.5 ? 2*t*t : -1+(4-2*t)*t;

      const step = (now)=>{
        let t = (now - t0)/duration;
        if(t>1) t=1;
        const te = ease(t);
        const x = (1-te)*(1-te)*P0.x + 2*(1-te)*te*P1.x + te*te*P2.x;
        const y = (1-te)*(1-te)*P0.y + 2*(1-te)*te*P1.y + te*te*P2.y;
        item.style.left = x+'px';
        item.style.top = y+'px';
        if(t<1){
          requestAnimationFrame(step);
        }else{
          item.remove();
          res();
        }
      };
      requestAnimationFrame(step);
    });
  }
  _crumbs(){
    for(let i=0;i<4;i++){
      const p = document.createElement('div');
      p.className = 'particle';
      const s = 3+Math.random()*4;
      p.style.width = s+'px'; p.style.height = s+'px';
      p.style.background = '#ffb74d';
      const bp = this._getBeakPoint();
      p.style.left = (bp.x + (Math.random()*14-7))+'px';
      p.style.top = (bp.y + (Math.random()*6-3))+'px';
      this.screenEl.appendChild(p);
      setTimeout(()=>p.remove(), 1200);
    }
  }
  _butterflyPlay(){
    const item = document.createElement('div');
    item.className = 'item'; item.textContent = '🦋';
    const scr = this.screenEl.getBoundingClientRect();
    const y = scr.height - 140;
    item.style.left = '8px'; item.style.top = y+'px';
    this.screenEl.appendChild(item);
    const targetX = scr.width - 36;
    const dur = 1200;
    const t0 = performance.now();
    const step = (now)=>{
      let t = (now - t0)/dur; if(t>1) t=1;
      const x = 8 + (targetX-8)*t;
      const yOsc = y + Math.sin(t*Math.PI*2)*18;
      item.style.left = x+'px'; item.style.top = yOsc+'px';
      if(t<1) requestAnimationFrame(step); else setTimeout(()=>item.remove(), 100);
    };
    requestAnimationFrame(step);
  }
  _waterClean(){
    const scr = this.screenEl.getBoundingClientRect();
    for(let i=0;i<16;i++){
      setTimeout(()=>{
        const d = document.createElement('div');
        d.className = 'splash';
        const x = 20 + Math.random()*(scr.width-40);
        d.style.left = x+'px';
        d.style.top = '-10px';
        this.screenEl.appendChild(d);
        const endY = scr.height - 70 - Math.random()*30;
        const dur = 600 + Math.random()*300;
        const t0 = performance.now();
        const step = (now)=>{
          let t = (now - t0)/dur; if(t>1) t=1;
          const y = -10 + (endY+10)*t;
          d.style.top = y+'px';
          if(t<1) requestAnimationFrame(step); else d.remove();
        };
        requestAnimationFrame(step);
      }, i*40);
    }
  }

  /* Actions with animations */
  feed(){
    if(this.dead) return;
    if(this.stats.sleeping){ this.showMessage("Shh! I'm sleeping peacefully! 😴"); return; }
    this.stats.hunger = Math.min(100, this.stats.hunger + 25);
    this.stats.happiness = Math.min(100, this.stats.happiness + 10);
    const msgs = [
      "Yummy! That was delicious! 🍎✨",
      "Thanks! I feel much better! 😋",
      "My feathers are getting shinier! 🦚",
      "More please! *chirp* 🐦💕"
    ];
    this.showMessage(msgs[(Math.random()*msgs.length)|0]);
    this.createSparkle();
    this.updatePeacockState(); this.updateDisplay();

    // Animation: comida vai até o bico
    this._animateEmojiToBeak('🍎', {startX: 26, duration: 900}).then(()=>{
      this._once(this.peacockEl,'act-peck',500);
      this._crumbs();
    });
  }

  play(){
    if(this.dead) return;
    if(this.stats.sleeping){ this.showMessage("Shh! I'm dreaming of dancing! 💃😴"); return; }
    if(this.stats.hunger < 20){ this.showMessage("I'm too hungry to display my tail! 😢"); return; }
    this.stats.happiness = Math.min(100, this.stats.happiness + 20);
    this.stats.hunger = Math.max(0, this.stats.hunger - 8);
    const msgs = [
      "Watch my dance! 💃✨",
      "Playing makes me so happy! 🎉",
      "Behold my beautiful tail! 🦚💖",
      "You're the best! 🥰"
    ];
    this.showMessage(msgs[(Math.random()*msgs.length)|0]);
    for(let i=0;i<3;i++) setTimeout(()=>this.createHeart(), i*300);
    this.updatePeacockState(); this.updateDisplay();

    // Animação: pulo + flare da cauda + borboleta
    this._once(this.peacockWrap,'act-hop',800);
    this._once(this.tailEl,'act-flare',1200);
    this._butterflyPlay();
  }

  heal(){
    if(this.dead) return;
    if(this.stats.sleeping){ this.showMessage("Medicine while I sleep... 💊😴"); }
    this.stats.health = Math.min(100, this.stats.health + 30);
    this.stats.happiness = Math.max(0, this.stats.happiness - 5);
    const msgs = [
      "Ugh, medicine tastes awful... but I feel better. 💊😷",
      "Thanks for taking care of me! 💚",
      "Plumage recovering its shine! ✨",
      "Feeling healthier already! 🦚"
    ];
    this.showMessage(msgs[(Math.random()*msgs.length)|0]);
    this.updatePeacockState(); this.updateDisplay();

    // Animação: pílula até o bico + piscada
    this._animateEmojiToBeak('💊', {startX: 60, duration: 800}).then(()=>{
      this.eyelidEl.style.opacity = '1';
      setTimeout(()=>this.eyelidEl.style.opacity='0', 300);
    });
  }

  clean(){
    if(this.dead) return;
    if(this.stats.sleeping){ this.showMessage("Dreaming of pristine feathers... 🛁😴"); return; }
    this.stats.happiness = Math.min(100, this.stats.happiness + 15);
    this.stats.health = Math.min(100, this.stats.health + 10);
    this.stats.dirty = false;
    const msgs = [
      "Feathers sparkling clean! ✨🦚",
      "I love being clean! 🛁💖",
      "Look how my colors shine! 🌈",
      "Perfect for a royal display! 👑"
    ];
    this.showMessage(msgs[(Math.random()*msgs.length)|0]);
    for(let i=0;i<4;i++) setTimeout(()=>this.createSparkle(), i*200);
    this.updatePeacockState(); this.updateDisplay();

    // Animação: gotas + chacoalhar
    this._waterClean();
    setTimeout(()=>this._once(this.peacockWrap,'act-shake',500), 450);
  }

  pet(){
    if(this.dead) return;
    if(this.stats.sleeping){
      this.showMessage("*purrs softly* 😴💕");
      this.stats.happiness = Math.min(100, this.stats.happiness + 5);
    } else {
      this.stats.happiness = Math.min(100, this.stats.happiness + 12);
      const msgs = [
        "Your gentle touch is perfect! 👋✨",
        "Mmm, that feels wonderful! 🥰",
        "I feel loved! 💕",
        "Peacocks love affection! 🐦💖"
      ];
      this.showMessage(msgs[(Math.random()*msgs.length)|0]);
      this.createHeart();
      const head = this.peacockEl.querySelector('.head');
      const neck = this.peacockEl.querySelector('.neck');
      head.classList.add('act-nuzzle');
      neck.classList.add('act-nuzzle');
      setTimeout(()=>{
        head.classList.remove('act-nuzzle');
        neck.classList.remove('act-nuzzle');
      }, 1000);
    }
    this.updatePeacockState(); this.updateDisplay();
  }

  sleep(){
    if(this.dead) return;
    this.stats.sleeping = !this.stats.sleeping;
    if(this.stats.sleeping){
      this.showMessage("Good night! Dreaming of gardens. 🌙💤");
      this.stats.happiness = Math.min(100, this.stats.happiness + 5);
      this.stats.health = Math.min(100, this.stats.health + 5);
      this._once(this.peacockWrap,'act-hop',600);
      setTimeout(()=>this.eyelidEl.style.opacity='1', 400);
    } else {
      this.showMessage("Good morning! Ready to show off! 🌅✨");
      this.stats.happiness = Math.min(100, this.stats.happiness + 10);
      this.stats.health = Math.min(100, this.stats.health + 10);
      this.createSparkle();
      this.eyelidEl.style.opacity='0';
      this._once(this.tailEl,'act-flare',900);
    }
    this.updatePeacockState(); this.updateDisplay();
  }

  randomEvent(){
    if(this.stats.sleeping) return;
    const events = [
      ()=>{
        this.stats.happiness = Math.min(100, this.stats.happiness + 15);
        this.showMessage("I found a mirror and admired myself! ✨🪞"); this.createSparkle();
      },
      ()=>{
        this.stats.hunger = Math.max(0, this.stats.hunger - 12);
        this.showMessage("Busy preening, forgot to eat! 🪶");
      },
      ()=>{
        this.stats.happiness = Math.min(100, this.stats.happiness + 18);
        this.showMessage("Magnificent courtship dance! 💃🦚");
        for(let i=0;i<3;i++) setTimeout(()=>this.createHeart(), i*400);
      },
      ()=>{
        if(!this.stats.dirty){
          this.stats.dirty = true; this.stats.happiness = Math.max(0, this.stats.happiness - 8);
          this.showMessage("Oops! Stepped in mud! 🌿💦");
        }
      },
      ()=>{
        this.stats.happiness = Math.min(100, this.stats.happiness + 12);
        this.showMessage("A butterfly landed on my beak! 🦋"); this.createSparkle();
      },
      ()=>{
        this.stats.hunger = Math.min(100, this.stats.hunger + 10);
        this.showMessage("Found delicious berries! 🫐");
      }
    ];
    if(Math.random() < 0.4){ events[(Math.random()*events.length)|0](); }
    this.updatePeacockState(); this.updateDisplay();
  }

  /* ===== Burn registry logic ===== */
  _dailyBurnAmount(day){ return day * 100; } // dia × 100 GOTCHI
  _loadBurnLog(){
    try{
      const raw = localStorage.getItem('gotchi_burn_log');
      const arr = raw ? JSON.parse(raw) : [];
      return Array.isArray(arr) ? arr : [];
    }catch(e){ return []; }
  }
  _saveBurnLog(){ 
    try{ localStorage.setItem('gotchi_burn_log', JSON.stringify(this.burnLog)); }catch(e){}
  }
  _registerDailyBurn(){
    const day = this.stats.age;
    if(day <= 0) { this._updateEggUI(); return; }
    if(this.burnLog.some(x => x.day === day)) { this._updateEggUI(); return; }
    const amount = this._dailyBurnAmount(day);
    const entry = { day, amount, ts: Date.now() };
    this.burnLog.push(entry);
    if(this.burnLog.length > 200) this.burnLog = this.burnLog.slice(-200);
    this._saveBurnLog();
    this._appendBurnRow(entry, true);
    this._flareEgg();
    this.showMessage(`Day ${day} reached. ${amount.toLocaleString()} GOTCHI burned. 🔥`);
    this._updateEggUI();
  }
  _sumTotal(){ return this.burnLog.reduce((s,e)=>s+e.amount,0); }
  _updateEggUI(){
    const todayAmt = this._dailyBurnAmount(this.stats.age);
    this.eggTodayEl.textContent = (this.stats.age>0? todayAmt.toLocaleString(): '0');
    this.eggTotalEl.textContent = `Total burned: ${this._sumTotal().toLocaleString()}`;
    if(!this._listHydrated){
      this.eggListEl.innerHTML = '';
      [...this.burnLog].sort((a,b)=>b.day-a.day).forEach(e=>this._appendBurnRow(e,false));
      this._listHydrated = true;
    }
  }
  _appendBurnRow(entry, prepend){
    const row = document.createElement('div');
    row.className = 'burn-row';
    row.innerHTML = `<b>Day ${entry.day}</b><span class="amt">${entry.amount.toLocaleString()} 🔥</span>`;
    if(prepend){ this.eggListEl.prepend(row); } else { this.eggListEl.appendChild(row); }
  }
  _flareEgg(){
    this.eggEl.classList.remove('egg-flare'); void this.eggEl.offsetWidth; this.eggEl.classList.add('egg-flare');
  }
}

/* Boot */
let cockgotchie;
window.onload = function(){ 
  cockgotchie = new Cockgotchie();

  const peacock = document.getElementById('peacock');
  peacock.addEventListener('click', ()=>{
    if(cockgotchie && !cockgotchie.dead && !cockgotchie.stats.sleeping) cockgotchie.pet();
  });
  peacock.addEventListener('mouseenter', ()=>{
    if(cockgotchie && !cockgotchie.dead && !cockgotchie.stats.sleeping && cockgotchie.stats.happiness > 50){
      cockgotchie.createSparkle();
    }
  });
};

/* Control wrappers */
function feedPeacock(){ cockgotchie && cockgotchie.feed(); }
function playWithPeacock(){ cockgotchie && cockgotchie.play(); }
function healPeacock(){ cockgotchie && cockgotchie.heal(); }
function cleanPeacock(){ cockgotchie && cockgotchie.clean(); }
function petPeacock(){ cockgotchie && cockgotchie.pet(); }
function putToSleep(){ cockgotchie && cockgotchie.sleep(); }

/* Prevent hash reload */
document.addEventListener('click', e=>{ if(e.target.matches('a[href^="#"]')) e.preventDefault(); });
</script>
</body>
</html>

